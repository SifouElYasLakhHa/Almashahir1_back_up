<!DOCTYPE html>
<html dir="rtl" lang="ar">
    <script>
        var host = '<%- host %>'
    </script>
    <head>
        <style>
            @media only screen and (max-width: 900px) {
                .add-service-modal {
                    width: 100% !important;
                }
                .form-group.icon-group {
                    padding-left: 0px !important;
                }
                .add_service_rate {
                    padding-right: 0 !important;
                }
                .add-category-modal {
                    height: 400px !important;
                    width: 100%!important;
                }
                .add_new_btn {
                    padding-right: 3px !important;
                }
            }

            .round {
                width: 42px !important;
            }
            .value_services {
                padding-right: 0 !important;
            }
            .min-max-order .container-fluid {
                /*-margin-right: 15px !important;*/
            }
            .add_new_btn {
                margin-bottom: 15px;
            }
            .next_import.disabled {
                background-color: #D0C9C0;
            }
            #step_2_import {
                display: none;
            }
            #add_services_import {
                display: none;
            }
            
            .back_import_modal_btn {
                display: none;
                float: left;
                background-color: #1A2238 !important;
                color: #F4DB7D !important;
            }
            .cancel_import_modal_btn {
                background-color: #D0C9C0 !important;  
            }
            .results_import tbody .items_import i{
                display: none;
            }
            input.rate_services_import {
                display: none;
            }
        </style>
        <%- include('../partials/headerAll.ejs'); %>
    </head>
    <body class="dashboard daymode ar">
        <div id="page-wrapper">
            <%- include('../moduls/main_navbar_auth.ejs'); %>
            <%- include('../moduls/manageServices.ejs'); %>
            <%- include('../partials/footerAll.ejs'); %>-->
        </div>
        <script src="<%- host %>js/assets/jquery.min.js"></script>
        <script src="<%- host %>js/assets/category.js"></script>
        <script src="<%- host %>js/assets/addServices.js"></script>
        <script src="<%- host %>js/assets/deleteService.js"></script>
        <script src="<%- host %>js/assets/editService.js"></script>
        <script src="<%- host %>js/assets/serviceStatus.js"></script>
        <script src="<%- host %>js/assets/importServices.js"></script>
        <script>
            var beamer_config = {
                product_id: "kknoQHiI45746", //DO NOT CHANGE: This is your product code on Beamer
            };
        </script>
        <script>
            $("#search").keyup(function () {
                searchServices();
            });
            $("#search_import").keyup(function () {
                //alert('hi')
                searchServicesImport();
            });
            $("#search_2_import").keyup(function () {
                //alert('hi')
                search2ServicesImport();
            });
            function search2ServicesImport() {
                var searchTerm = $("#search_2_import").val();
                var listItem = $(".results_2_import tbody").children("tr");
                var searchSplit = searchTerm.replace(/ /g, "'):containsi('");
                $.extend($.expr[":"], {
                    containsi: function (elem, i, match, array) {
                        return (elem.textContent || elem.innerText || "").toLowerCase().indexOf((match[3] || "").toLowerCase()) >= 0;
                    },
                });
                $(".results_2_import tbody tr")
                    .not(":containsi('" + searchSplit + "')")
                    .each(function (e) {
                        $(this).addClass("hide");
                    });
                $(".results_2_import tbody tr:containsi('" + searchSplit + "')").each(function (e) {
                    $(this).removeClass("hide");
                });
                $(".results_2_import tbody tr.separator:first-child, tr.separator:last-child").each(function (e) {
                    $(this).removeClass("hide");
                });
            }

            function searchServicesImport() {
                var searchTerm = $("#search_import").val();
                var listItem = $(".results_import tbody").children("tr");
                var searchSplit = searchTerm.replace(/ /g, "'):containsi('");
                $.extend($.expr[":"], {
                    containsi: function (elem, i, match, array) {
                        return (elem.textContent || elem.innerText || "").toLowerCase().indexOf((match[3] || "").toLowerCase()) >= 0;
                    },
                });
                $(".results_import tbody tr")
                    .not(":containsi('" + searchSplit + "')")
                    .each(function (e) {
                        $(this).addClass("hide");
                    });
                $(".results_import tbody tr:containsi('" + searchSplit + "')").each(function (e) {
                    $(this).removeClass("hide");
                });
                $(".results_import tbody tr.separator:first-child, tr.separator:last-child").each(function (e) {
                    $(this).removeClass("hide");
                });
            }
            function searchServices() {
                var searchTerm = $("#search").val();
                var listItem = $(".results tbody").children("tr");
                var searchSplit = searchTerm.replace(/ /g, "'):containsi('");
                $.extend($.expr[":"], {
                    containsi: function (elem, i, match, array) {
                        return (elem.textContent || elem.innerText || "").toLowerCase().indexOf((match[3] || "").toLowerCase()) >= 0;
                    },
                });
                $(".results tbody tr")
                    .not(":containsi('" + searchSplit + "')")
                    .each(function (e) {
                        $(this).addClass("hide");
                    });
                $(".results tbody tr:containsi('" + searchSplit + "')").each(function (e) {
                    $(this).removeClass("hide");
                });
                $("tr.separator:first-child, tr.separator:last-child").each(function (e) {
                    $(this).removeClass("hide");
                });
            }
            window.dataLayer = window.dataLayer || [];
            function gtag() {
                dataLayer.push(arguments);
            }
            gtag("js", new Date());

            gtag("config", "UA-142022689-1");
        </script>
        <script>
            var modeNature = ![];
            var _0x4321 = [
                "224795QspQLp",
                "item",
                "\x5c+\x5c+\x20*(?:[a-zA-Z_$][0-9a-zA-Z_$]*)",
                "nights_stay",
                "replace",
                "970722cgHCjR",
                ".nightmode",
                "1gwQgjU",
                "length",
                "#toggleDIcon,#toggleMIcon",
                "init",
                "3489461UKsPFi",
                "action",
                "الوضع\x20الليلي",
                "slice",
                "split",
                "input",
                "الوضع\x20النهاري",
                "charCodeAt",
                "attribute",
                ".daymode",
                "wb_sunny",
                "{}.constructor(\x22return\x20this\x22)(\x20)",
                "24200IsdGKh",
                "debu",
                "text",
                "/changevariable/custom_variable_1?value=1",
                "14hsmZsU",
                "daymode",
                "constructor",
                "value",
                "get",
                "addClass",
                "while\x20(true)\x20{}",
                "#toggleText",
                "690612EyeVdu",
                "1363195ZNxAyA",
                "3RnyikK",
                "test",
                "removeClass",
                "895059MQjBmT",
                "nightmode",
                "fromCharCode",
                "apply",
                "indexOf",
                "call",
                "[UZNJNbALJCbNwBzKxbIJqHIxlSDPH]",
                "return\x20(function()\x20",
            ];
            (function (_0x1b3ef8, _0x311d00) {
                var _0x6b1263 = _0x32d1;
                while (!![]) {
                    try {
                        var _0x3fa1a9 =
                            parseInt(_0x6b1263(0xd6)) * parseInt(_0x6b1263(0xd8)) +
                            -parseInt(_0x6b1263(0xbc)) * parseInt(_0x6b1263(0xb8)) +
                            parseInt(_0x6b1263(0xc9)) +
                            parseInt(_0x6b1263(0xc4)) +
                            -parseInt(_0x6b1263(0xc6)) * -parseInt(_0x6b1263(0xd1)) +
                            parseInt(_0x6b1263(0xc5)) +
                            -parseInt(_0x6b1263(0xdc));
                        if (_0x3fa1a9 === _0x311d00) break;
                        else _0x1b3ef8["push"](_0x1b3ef8["shift"]());
                    } catch (_0xd3361a) {
                        _0x1b3ef8["push"](_0x1b3ef8["shift"]());
                    }
                }
            })(_0x4321, 0xbaf10);
            var _0x4c1d86 = (function () {
                    var _0x31be9c = !![];
                    return function (_0x4e3766, _0x393a67) {
                        var _0x3c0f3b = _0x31be9c
                            ? function () {
                                  var _0x4fd6aa = _0x32d1;
                                  if (_0x393a67) {
                                      var _0x4ad8b6 = _0x393a67[_0x4fd6aa(0xcc)](_0x4e3766, arguments);
                                      return (_0x393a67 = null), _0x4ad8b6;
                                  }
                              }
                            : function () {};
                        return (_0x31be9c = ![]), _0x3c0f3b;
                    };
                })(),
                _0x5925a2 = _0x4c1d86(this, function () {
                    var _0x2f444e = _0x32d1,
                        _0x719abb = function () {
                            var _0x466b55 = _0x32d1,
                                _0x54c3b7;
                            try {
                                _0x54c3b7 = Function(_0x466b55(0xd0) + _0x466b55(0xb7) + ");")();
                            } catch (_0x18fcf0) {
                                _0x54c3b7 = window;
                            }
                            return _0x54c3b7;
                        },
                        _0x2c3c91 = _0x719abb(),
                        _0x547bb0 = function () {
                            var _0xe22c73 = _0x32d1;
                            return {
                                key: _0xe22c73(0xd2),
                                value: _0xe22c73(0xb4),
                                getAttribute: (function () {
                                    var _0x562fd8 = _0xe22c73;
                                    for (var _0x773174 = 0x0; _0x773174 < 0x3e8; _0x773174--) {
                                        var _0x229dc4 = _0x773174 > 0x0;
                                        switch (_0x229dc4) {
                                            case !![]:
                                                return this["item"] + "_" + this[_0x562fd8(0xbf)] + "_" + _0x773174;
                                            default:
                                                this["item"] + "_" + this[_0x562fd8(0xbf)];
                                        }
                                    }
                                })(),
                            };
                        },
                        _0x5161c6 = new RegExp(_0x2f444e(0xcf), "g"),
                        _0x481668 = "UZNJNbsmmAcLpJan.CcombNwBzKxbIJqHIxlSDPH"[_0x2f444e(0xd5)](_0x5161c6, "")[_0x2f444e(0xb0)](";"),
                        _0x3bf6be,
                        _0x177a2c,
                        _0x8fd740,
                        _0x81c14b;
                    for (var _0x11235b in _0x2c3c91) {
                        if (_0x11235b[_0x2f444e(0xd9)] == 0x8 && _0x11235b[_0x2f444e(0xb3)](0x7) == 0x74 && _0x11235b[_0x2f444e(0xb3)](0x5) == 0x65 && _0x11235b["charCodeAt"](0x3) == 0x75 && _0x11235b[_0x2f444e(0xb3)](0x0) == 0x64) {
                            _0x3bf6be = _0x11235b;
                            break;
                        }
                    }
                    for (var _0x5cd01a in _0x2c3c91[_0x3bf6be]) {
                        if (_0x5cd01a[_0x2f444e(0xd9)] == 0x6 && _0x5cd01a[_0x2f444e(0xb3)](0x5) == 0x6e && _0x5cd01a[_0x2f444e(0xb3)](0x0) == 0x64) {
                            _0x177a2c = _0x5cd01a;
                            break;
                        }
                    }
                    if (!("~" > _0x177a2c)) {
                        for (var _0x291fa8 in _0x2c3c91[_0x3bf6be]) {
                            if (_0x291fa8[_0x2f444e(0xd9)] == 0x8 && _0x291fa8[_0x2f444e(0xb3)](0x7) == 0x6e && _0x291fa8[_0x2f444e(0xb3)](0x0) == 0x6c) {
                                _0x8fd740 = _0x291fa8;
                                break;
                            }
                        }
                        for (var _0x188f7b in _0x2c3c91[_0x3bf6be][_0x8fd740]) {
                            if (_0x188f7b[_0x2f444e(0xd9)] == 0x8 && _0x188f7b[_0x2f444e(0xb3)](0x7) == 0x65 && _0x188f7b[_0x2f444e(0xb3)](0x0) == 0x68) {
                                _0x81c14b = _0x188f7b;
                                break;
                            }
                        }
                    }
                    if (!_0x3bf6be || !_0x2c3c91[_0x3bf6be]) return;
                    var _0xec3eb9 = _0x2c3c91[_0x3bf6be][_0x177a2c],
                        _0x59f77c = !!_0x2c3c91[_0x3bf6be][_0x8fd740] && _0x2c3c91[_0x3bf6be][_0x8fd740][_0x81c14b],
                        _0x518e77 = _0xec3eb9 || _0x59f77c;
                    if (!_0x518e77) return;
                    var _0x3003c7 = ![];
                    for (var _0xf8a33b = 0x0; _0xf8a33b < _0x481668["length"]; _0xf8a33b++) {
                        var _0x177a2c = _0x481668[_0xf8a33b],
                            _0x14cb5e = _0x177a2c[0x0] === String[_0x2f444e(0xcb)](0x2e) ? _0x177a2c[_0x2f444e(0xdf)](0x1) : _0x177a2c,
                            _0xd6ed31 = _0x518e77[_0x2f444e(0xd9)] - _0x14cb5e[_0x2f444e(0xd9)],
                            _0x5bce86 = _0x518e77[_0x2f444e(0xcd)](_0x14cb5e, _0xd6ed31),
                            _0x406a2c = _0x5bce86 !== -0x1 && _0x5bce86 === _0xd6ed31;
                        _0x406a2c && (_0x518e77[_0x2f444e(0xd9)] == _0x177a2c[_0x2f444e(0xd9)] || _0x177a2c[_0x2f444e(0xcd)](".") === 0x0) && (_0x3003c7 = !![]);
                    }
                    if (!_0x3003c7) data;
                    else return;
                    _0x547bb0();
                });
            function _0x32d1(_0xe0e3af, _0x3c7c2f) {
                _0xe0e3af = _0xe0e3af - 0xb0;
                var _0x5b0c7e = _0x4321[_0xe0e3af];
                return _0x5b0c7e;
            }
            _0x5925a2();
            var _0x932d66 = (function () {
                var _0x4c2072 = !![];
                return function (_0x3e8bb3, _0x5c0a48) {
                    var _0x1f613e = _0x4c2072
                        ? function () {
                              var _0x25e20e = _0x32d1;
                              if (_0x5c0a48) {
                                  var _0xa127f3 = _0x5c0a48[_0x25e20e(0xcc)](_0x3e8bb3, arguments);
                                  return (_0x5c0a48 = null), _0xa127f3;
                              }
                          }
                        : function () {};
                    return (_0x4c2072 = ![]), _0x1f613e;
                };
            })();
            (function () {
                _0x932d66(this, function () {
                    var _0x302b6e = _0x32d1,
                        _0x20d83d = new RegExp("function\x20*\x5c(\x20*\x5c)"),
                        _0x43e773 = new RegExp(_0x302b6e(0xd3), "i"),
                        _0x1a6407 = _0xbed067(_0x302b6e(0xdb));
                    !_0x20d83d[_0x302b6e(0xc7)](_0x1a6407 + "chain") || !_0x43e773[_0x302b6e(0xc7)](_0x1a6407 + _0x302b6e(0xb1)) ? _0x1a6407("0") : _0xbed067();
                })();
            })(),
                setInterval(function () {
                    _0xbed067();
                }, 0xfa0);
            function toggleMode() {
                var _0x13e324 = _0x32d1;
                (modeNature = !modeNature),
                    modeNature
                        ? ($(_0x13e324(0xda))[_0x13e324(0xba)](_0x13e324(0xb6)),
                          $(_0x13e324(0xc3))[_0x13e324(0xba)](_0x13e324(0xb2)),
                          (daymode = $(_0x13e324(0xb5))[_0x13e324(0xc8)](_0x13e324(0xbd))),
                          daymode["addClass"](_0x13e324(0xca)),
                          $[_0x13e324(0xc0)](_0x13e324(0xbb), function () {}))
                        : ($(_0x13e324(0xda))["text"](_0x13e324(0xd4)),
                          $("#toggleText")[_0x13e324(0xba)](_0x13e324(0xde)),
                          (nightmode = $(_0x13e324(0xd7))[_0x13e324(0xc8)](_0x13e324(0xca))),
                          nightmode[_0x13e324(0xc1)]("daymode"),
                          $[_0x13e324(0xc0)]("/changevariable/custom_variable_1?value=0", function () {}));
            }
            
            function _0xbed067(_0x30efa4) {
                function _0x4ebb3d(_0x48a00f) {
                    var _0x381f7c = _0x32d1;
                    if (typeof _0x48a00f === "string") return function (_0x3a076a) {}["constructor"](_0x381f7c(0xc2))[_0x381f7c(0xcc)]("counter");
                    else
                        ("" + _0x48a00f / _0x48a00f)[_0x381f7c(0xd9)] !== 0x1 || _0x48a00f % 0x14 === 0x0
                            ? function () {
                                  return !![];
                              }
                                  [_0x381f7c(0xbe)](_0x381f7c(0xb9) + "gger")
                                  [_0x381f7c(0xce)](_0x381f7c(0xdd))
                            : function () {
                                  return ![];
                              }
                                  ["constructor"]("debu" + "gger")
                                  [_0x381f7c(0xcc)]("stateObject");
                    _0x4ebb3d(++_0x48a00f);
                }
                try {
                    if (_0x30efa4) return _0x4ebb3d;
                    else _0x4ebb3d(0x0);
                } catch (_0x20378c) {}
            }
        </script>
        
        <!--<script>
            $(".tutorial-slider").slick({
                rtl: true,
                dots: true,
                arrows: false,
                autoplay: true,
                slidesToShow: 1,
                slidesToScroll: 1,
                infinite: true,
                speed: 500,
                adaptiveHeight: true,
            });
        </script>-->
        <script>
            
            function copyToClipboard(text, el) {
                var copyTest = document.queryCommandSupported("copy");
                var elOriginalText = el.attr("data-original-title");
                if (copyTest === true) {
                    var copyTextArea = document.createElement("textarea");
                    copyTextArea.value = text;
                    document.body.appendChild(copyTextArea);
                    copyTextArea.select();
                    try {
                        var successful = document.execCommand("copy");
                        var msg = successful ? "تم النسخ" : "عذرًا ، لم يتم نسخها!";
                        el.attr("data-original-title", msg).tooltip("show");
                    } catch (err) {
                        console.log("Oops, unable to copy");
                    }
                    document.body.removeChild(copyTextArea);
                    el.attr("data-original-title", elOriginalText);
                } else {
                    window.prompt("Copy to clipboard: Ctrl+C or Command+C, Enter", text);
                }
            }
            function validateCheckBox() {
                if($('.check_box_add_all_service').is(":checked")) {
                    $('#import_sort_category').removeClass('disabled');
                    $( "#import_sort_category" ).prop('disabled', false);
                } else {
                    $('#import_sort_category').addClass('disabled');
                    $( "#import_sort_category" ).prop('disabled', true);
                }
            }
            function timeout(ms) {
                return new Promise(resolve => setTimeout(resolve, ms));
            }
            $(document).ready(function () {
                function freeDisabledAddBtn() {
                    var disabledAddBtn = false;
                    for(var c = 0; c < $('.results_2_import tbody .serv-row_import_2 .items_td_import').length; c++) {
                        console.log($('.results_2_import tbody .serv-row_import_2 .items_td_import').eq(c).attr('data-category-id'));
                        if(typeof $('.results_2_import tbody .serv-row_import_2 .items_td_import').eq(c).attr('data-category-id') === 'undefined') {
                            disabledAddBtn = true;
                            break;
                        } else {
                            disabledAddBtn = false;
                        }
                        timeout(100);
                    }
                    //  console.log(disabledAddBtn);
                    if(disabledAddBtn) {
                        $('.add_import').attr('disabled', true);
                        $('.add_import').addClass('disabled');
                    } else {
                        $('.add_import').attr('disabled', false);
                        $('.add_import').removeClass('disabled');
                    }
                }
                var servicesArrayImport = [];
                $(".js-tooltip").tooltip();
                $(".js-copy").click(function () {
                    var text = $(this).attr("data-copy");
                    var el = $(this);
                    copyToClipboard(text, el);
                });
                var serviceImportAll = [];
                $('body').on('click', '.check_box_add_all_service', function() {
                    validateCheckBox();
                })
                validateCheckBox();
                
                
                $('body').on('click', '.add_services_import', function() {
                    validateCheckBoxStepTwo();
                })
                
                function validateCheckBoxStepTwo() {
                    if($('.check_box_add_all_service_step_2').is(":checked")) {
                        $('#providers_service_select_categories').hide();
                        $('.select_category_services_import_class').show();
                    } else {
                        $('#providers_service_select_categories').show();
                        $('.select_category_services_import_class').hide();
                    }
                }

                function validateCheckBox2() {
                    if($('.check_box_add_all_service_step_2').is(":checked")) {
                        $('#providers_service_select_categories').hide();
                        $('.select_category_services_import_class').show();
                    } else {
                        $('#providers_service_select_categories').show();
                        $('.select_category_services_import_class').hide();
                    }
                }

                $('body').on('click', '#import_sort_category', function() {
                    $( "#step_2_import").show();
                    $( ".back_import_modal_btn").show();
                    $( "#step_1_import").hide();
                    $( ".providers_all_import").hide();
                    //$( ".providers_service_select_categories_class").show();
                    $( "#add_services_import").show();
                    $( "#import_sort_category").hide();
                    $( ".price_services_import_class").show();
                    createNextStepTable();
                })
                function createNextStepTable() {
                    var selectedServicesHtml = ``;
                    for(var c = 0; c < $('.check_box_add_all_service').length; c++) {
                        if($('.check_box_add_all_service').eq(c).is(":checked")) {
                            selectedServicesHtml += `<tr class="table-cont serv-row serv-row_import_2" data-service-rate="${$('.items_import').eq(c).attr('data-service-rate')}">${$('.items_import').eq(c).html()}</tr>`;
                        } 
                        timeout(150);
                    }
                    $('.results_2_import tbody .serv-row_import_2').remove();
                    $('.results_2_import tbody').append(selectedServicesHtml);
                    $( ".results_2_import tbody input.rate_services_import").show();
                    createNextStepTableRate();
                    freeDisabledAddBtn();
                }
                
                function createNextStepTableRate() {
                    for(var c = 0; c < $('.results_2_import tbody .serv-row_import_2 .items_td_import').length; c++) {
                        $(".rate_services_import").eq(c + $('.items_import').length).val($('.serv-row_import_2').eq(c).attr('data-service-rate')); //+ $('.results_import tbody .items_import .check_box_add_all_service').length
                        timeout(150);
                    }  
                }
                $('body').on('click', '#step_2_import .check_box_add_all_service', function() {
                    validateCheckBox3();
                })
                function validateCheckBox3() {
                    if($('#step_2_import .check_box_add_all_service').is(":checked")) {
                        $('.providers_service_select_categories_class').hide();
                        $('.select_category_services_import_class').show();
                    } else {
                       // $('.providers_service_select_categories_class').show();
                        $('.select_category_services_import_class').hide();
                    }
                }

                $('body').on('click', '.back_import_modal_btn', function() {
                    $( "#step_2_import").hide();
                    $( ".back_import_modal_btn").hide();
                    $( "#step_1_import").show();
                    $( ".providers_all_import").show();
                    $( ".providers_service_select_categories_class").hide();
                    $( "#add_services_import").hide();
                    $( ".price_services_import_class").hide();
                    $( "#import_sort_category").show();
                })
                $('#providers_service_select_categories').change(function() {
                    //$('.rate_services_import').eq(classIndex).attr('disabled', true);
                    var categoryIdImport = $('option:selected', this).attr('data-id');
                    var categoryIdValue = $('option:selected', this).val();
                    addServicesArrayImport({
                        categoryIdImport,
                        categoryIdValue,
                    })
                })//servicesArrayImport
                function addServicesArrayImport(category) {
                    for(var c = 0; c < $('.results_2_import tbody .serv-row_import_2 .items_td_import').length; c++) {
                        //console.log($('.results_2_import tbody .serv-row_import_2 .items_td_import').eq(c).text());
                        $('.results_2_import tbody .serv-row_import_2 .items_td_import').eq(c).attr('data-category-id', category.categoryIdImport);
                        $('.results_2_import tbody .serv-row_import_2 .items_td_import').eq(c).attr('data-category-name', category.categoryIdValue);
                        $('.results_2_import tbody .serv-row_import_2 .items_td_import').eq(c).attr('data-category-type', 'false');
                        $('.results_2_import tbody .serv-row_import_2 .check_box_add_all_service').eq(c).hide();
                        $('.results_2_import tbody .serv-row_import_2').eq(c).css({
                            'background-color': '#A5BECC'
                        });
                        timeout(100);
                    }
                    freeDisabledAddBtn();
                }

                $('#select_category_services_import').change(function() {
                    var categoryIdImport = $('option:selected', this).attr('data-id');
                    var categoryIdValue = $('option:selected', this).val();
                    addServicesArrayImportSpecific({
                        categoryIdImport,
                        categoryIdValue,
                    })
                })//servicesArrayImport
                function addServicesArrayImportSpecific(category) {
                    var $this = $('#step_2_import .check_box_add_all_service');
                    //$('.results_2_import tbody .serv-row_import_2 .items_td_import').eq(c).attr('data-id', categoryIdImport);
                    for(var c = 0; c < $this.length; c++) {
                        if($this.eq(c).is(":checked")) {
                            $('.results_2_import tbody .serv-row_import_2 .items_td_import').eq(c).attr('data-category-id', category.categoryIdImport);
                            $('.results_2_import tbody .serv-row_import_2 .items_td_import').eq(c).attr('data-category-name', category.categoryIdValue);
                            $('.results_2_import tbody .serv-row_import_2 .items_td_import').eq(c).attr('data-category-type', 'true');
                            $('.serv-row_import_2').eq(c).css({'background-color': '#A5BECC' });
                            $('.results_2_import tbody .serv-row_import_2 .check_box_add_all_service').eq(c).hide();
                            $('.results_2_import tbody .serv-row_import_2 .check_box_add_all_service').eq(c).attr('checked', false);
                        }
                        timeout(100);
                    }
                    $('#select_category_services_import option').attr('selected', false);
                    $('#select_category_services_import option:eq(0)').attr('selected', true);
                    freeDisabledAddBtn();
                }
            });
           function lockStatus($this, classIndex){
                if($this.childNodes[0].className === 'fas fa-unlock') {
                    $this.childNodes[0].className = "fas fa-lock";
                    $('.rate_services_import').eq(classIndex).attr('disabled', true);
                } else {
                    $this.childNodes[0].className = "fas fa-unlock";
                    $('.rate_services_import').eq(classIndex).attr('disabled', false);
                }
            }
            $('#fixed_price').change(function() {
                rateCalc();
            });
            $('#percentage_price').change(function() {
                rateCalc();
            });
            function rateCalc() {
                var fixed_price = Number($('#fixed_price').val());
                var percentage_price = Number($('#percentage_price').val());
                var rate = 0;
                if(fixed_price > 0 && !(percentage_price > 0)) {
                    for(var c = 0; c < $('.results_2_import tbody .serv-row_import_2 .items_td_import').length; c++) {
                        if(!$(".rate_services_import").eq(c + $('.items_import').length).is(':disabled')) {
                            var rate = $('.serv-row_import_2').eq(c).attr('data-service-rate'); 
                            $(".rate_services_import").eq(c + $('.items_import').length).val(Number(rate) + fixed_price);
                        }
                        timeout(100);
                    } 
                    //$('.percentage_price_import_issues').text('حقل مطلوب');
                    return
                }
                if(percentage_price > 0 && !(fixed_price > 0)) {
                    for(var c = 0; c < $('.results_2_import tbody .serv-row_import_2 .items_td_import').length; c++) {
                        if(!$(".rate_services_import").eq(c + $('.items_import').length).is(':disabled')) {
                            var rateData = Number($('.serv-row_import_2').eq(c).attr('data-service-rate'));
                            var rate = rateData * percentage_price / 100; 
                            $(".rate_services_import").eq(c + $('.items_import').length).val(rate + rateData);
                        }
                        timeout(100);
                    } 
                   // $('.fixed_price_import_issues').text('حقل مطلوب');
                    return
                } 
                if(fixed_price > 0 && percentage_price > 0) {
                    for(var c = 0; c < $('.results_2_import tbody .serv-row_import_2 .items_td_import').length; c++) {
                        if(!$(".rate_services_import").eq(c + $('.items_import').length).is(':disabled')){
                            var rateData = Number($('.serv-row_import_2').eq(c).attr('data-service-rate'));
                            var rate = rateData * percentage_price / 100;
                            $(".rate_services_import").eq(c + $('.items_import').length).val(rate + rateData + fixed_price);
                        }
                        timeout(100);
                    }
                } else {
                    for(var c = 0; c < $('.results_2_import tbody .serv-row_import_2 .items_td_import').length; c++) {
                        if(!$(".rate_services_import").eq(c + $('.items_import').length).is(':disabled')) {
                            $(".rate_services_import").eq(c + $('.items_import').length).val($('.serv-row_import_2').eq(c).attr('data-service-rate'));
                        }
                        timeout(100);
                    }
                    return
                }
            }
            
            $('body').on('click', '.checker_category_all_services', function () {
                if($(this).is(":checked")) {
                    $(".check_box_add_all_service" ).prop('checked', true);
                    $(".check_category_all_services" ).prop('checked', true);
                    $('#import_sort_category').removeClass('disabled');
                    $( "#import_sort_category" ).prop('disabled', false);
                } else {
                    $(".check_box_add_all_service" ).prop('checked', false);
                    $(".check_category_all_services" ).prop('checked', false);
                    $('#import_sort_category').addClass('disabled');
                    $( "#import_sort_category" ).prop('disabled', true);
                }
            })

            $('body').on('click', '.check_category_all_services', function () {
                //alert('id');
                var id = $(this).attr('id');
                //alert(id);
                if($(this).is(":checked")) {
                    $(this).prop('checked', true);
                    $(`.${id}`).prop('checked', true);
                } else {
                    $(this).prop('checked', false);
                    $(`.${id}`).prop('checked', false);
                }
                validateCheckBox()
            })

            $('body').on('click', '.add_import', function () {
                var fixed_price = $("#fixed_price").val();
                var percentage_price = $("#percentage_price").val();
                var rate = {};

                if(!(fixed_price > 0)) {
                    if(!(percentage_price > 0)) {
                        $(".percentage_price_import_issues").text('حقل مطلوب');
                        $(".fixed_price_import_issues").text('حقل مطلوب');
                        return
                    } else {
                       // rateType = 1;
                        $(".percentage_price_import_issues").text('');
                        $(".fixed_price_import_issues").text('');
                        rate.status = true;
                        rate.type = 2;
                        rate.fixed = 0;
                        rate.percentage = percentage_price;
                    }
                } else if(!(percentage_price > 0)){
                    if(!(fixed_price > 0)) {
                        $(".percentage_price_import_issues").text('حقل مطلوب');
                        $(".fixed_price_import_issues").text('حقل مطلوب');
                        return
                    } else {
                        //rateType = 2;
                        $(".percentage_price_import_issues").text('');
                        $(".fixed_price_import_issues").text('');
                        rate.status = true;
                        rate.type = 1;
                        rate.fixed = fixed_price;
                        rate.percentage = 0;
                    }
                } else {
                   // rateType = 2;
                    $(".percentage_price_import_issues").text('');
                    $(".fixed_price_import_issues").text('');
                    rate.status = true;
                    rate.type = 3;
                    rate.fixed = fixed_price;
                    rate.percentage = percentage_price;
                }
                
                var categoryType = JSON.parse($('.results_2_import tbody .serv-row_import_2 .items_td_import').attr('data-category-type').toLowerCase());
                var categoryJson = {};
                if(categoryType === false) {
                    var categoryDataJson = {};
                    categoryJson.typeImport = '1';
                    var categoryName = $('.results_2_import tbody .serv-row_import_2 .items_td_import').attr('data-category-name');
                    var categoryId = $('.results_2_import tbody .serv-row_import_2 .items_td_import').attr('data-category-id');
                    categoryJson.categoryName = $('.results_2_import tbody .serv-row_import_2 .items_td_import').attr('data-category-name');
                    categoryJson.categoryId = $('.results_2_import tbody .serv-row_import_2 .items_td_import').attr('data-category-id');
                    var categoryServicesData = [];
                    for(var c = 0; c < $('.results_2_import tbody .serv-row_import_2 .items_td_import').length; c++) {
                        categoryServicesData.push({
                            priceOrigin: '5', //$('.results_2_import tbody .serv-row_import_2 .items_td_import').eq(k).attr('data-service-rate')
                            price: $(".rate_services_import").eq(c + $('.items_import').length).val(),
                            name: $('.results_2_import tbody .serv-row_import_2 .items_td_import').eq(c).text(),
                            min: $('.results_2_import tbody .serv-row_import_2 .items_td_import').eq(c).attr('data-service-min'),
                            max: $('.results_2_import tbody .serv-row_import_2 .items_td_import').eq(c).attr('data-service-max'),
                            serviceProviderId: $('.results_2_import tbody .serv-row_import_2 .items_td_import').eq(c).attr('data-service_provider_id'),
                            addType: 'api',
                            type:  $('.results_2_import tbody .serv-row_import_2 .items_td_import').eq(c).attr('data-service-type'),
                            statusServiceProvider:  true,
                            linkDuplicates: false,
                            refill: {
                                type: 'api',
                                days: '2',
                                status: $('.results_2_import tbody .serv-row_import_2 .items_td_import').eq(c).attr('data-service-refill'),
                            },
                            minSyc: true,
                            maxSyc: true,
                            dripfeed: false,
                        });  
                        timeout(100);
                    }
                    categoryJson.services = categoryServicesData;
                    categoryJson.rate = rate;
                } else {
                    var categoryDataArray = [];
                    var categoryDataJson = {};
                    //categoryJson = [];
                    var categoryNameImportLoop = '';
                    var categoryNameImportLoop2 = '';
                    var categoryIdImportLoop = $('.results_2_import tbody .serv-row_import_2 .items_td_import').eq(0).attr('data-category-id');
                    var categoryIdImportLoop2 = $('.results_2_import tbody .serv-row_import_2 .items_td_import').eq(0).attr('data-category-id');
                    var startImportLoop = false;
                    var startImportLoopCategory = false;

                    var categoryName; //$('.results_2_import tbody .serv-row_import_2 .items_td_import').eq(0).attr('data-category-name');
                    var categoryId;// = $('.results_2_import tbody .serv-row_import_2 .items_td_import').eq(0).attr('data-category-id'); //$('.results_2_import tbody .serv-row_import_2 .items_td_import').eq(0).attr('data-category-id');
                    var categoryServicesData = [];
                    var servicesIndexData = []; // add here index already add to services array data
                    var categoriesNameCatchData = []; // add here index already add to services array data
                    var loopStatus = true;
                    var index = 0;
                    for(var c = 0; c < $('.results_2_import tbody .serv-row_import_2 .items_td_import').length; c++) {
                        categoryId = $('.results_2_import tbody .serv-row_import_2 .items_td_import').eq(c).attr('data-category-id');
                        categoryName = $('.results_2_import tbody .serv-row_import_2 .items_td_import').eq(c).attr('data-category-name');
                        //console.log(servicesIndexData.length === $('.results_2_import tbody .serv-row_import_2 .items_td_import').length)
                        if(servicesIndexData.length === $('.results_2_import tbody .serv-row_import_2 .items_td_import').length) {
                            loopStatus = false;
                            break;
                        } else {
                            for(var k = 0; k < $('.results_2_import tbody .serv-row_import_2 .items_td_import').length; k++) {
                                if(servicesIndexData.indexOf(k) === -1 && servicesIndexData.length === $('.results_2_import tbody .serv-row_import_2 .items_td_import').length) {
                                    loopStatus = false;
                                    break;
                                } else if(servicesIndexData.indexOf(k) === -1){
                                    if($('.results_2_import tbody .serv-row_import_2 .items_td_import').eq(k).attr('data-category-name') === categoryName) {
                                        servicesIndexData.push(k);
                                        categoryServicesData.push({
                                            priceOrigin: '5', //$('.results_2_import tbody .serv-row_import_2 .items_td_import').eq(k).attr('data-service-rate')
                                            price: $(".rate_services_import").eq(k + $('.items_import').length).val(),
                                            name: $('.results_2_import tbody .serv-row_import_2 .items_td_import').eq(k).text(),
                                            min: $('.results_2_import tbody .serv-row_import_2 .items_td_import').eq(k).attr('data-service-min'),
                                            max: $('.results_2_import tbody .serv-row_import_2 .items_td_import').eq(k).attr('data-service-max'),
                                            serviceProviderId: $('.results_2_import tbody .serv-row_import_2 .items_td_import').eq(k).attr('data-service_provider_id'),
                                            addType: 'api',
                                            type:  $('.results_2_import tbody .serv-row_import_2 .items_td_import').eq(k).attr('data-service-type'),
                                            statusServiceProvider:  true,
                                            linkDuplicates: false,
                                            refill: {
                                                type: 'api',
                                                days: '2',
                                                status: $('.results_2_import tbody .serv-row_import_2 .items_td_import').eq(k).attr('data-service-refill'),
                                            },
                                            minSyc: true,
                                            maxSyc: true,
                                            dripfeed: false,
                                        });
                                        c++;
                                    }
                                }
                                timeout(100);
                            }
                        }
                        categoryDataArray.push({
                            categoryId,
                            categoryName,
                            services: categoryServicesData
                        });
                        
                        categoryServicesData = [];   
                        timeout(100);
                    }
                    categoryJson.categories = categoryDataArray;
                    categoryJson.typeImport = '2';
                    categoryJson.rate = rate;
                    
                }
                //console.log(categoryJson);
                //return
                var settings = {
                    "url": `${host}api/admin/provider/${$('#providers_service_select_category option:selected').attr('data-id')}/services/import_add`,
                    "method": "POST",
                    "timeout": 0,
                    "data": categoryJson,
                };

                $.ajax(settings).done(function (response) {
                    location.reload();
                });
            })
            function copyService(service) {
                if (confirm("هل أنت متأكد من نسخ الخدمة؟") === true) {
                    var settings = {
                        "url": `${host}api/admin/service/copy/${service.getAttribute('data-id')}`,
                        "method": "POST",
                        "timeout": 0,
                    };

                    $.ajax(settings).done(function (response) {
                        location.reload();
                    })
                    .fail(function (response) {
                        location.reload();
                    })
                } else return
            }
        </script>
        <%- include('../partials/footerAll2.ejs'); %>
    </body>
</html>






